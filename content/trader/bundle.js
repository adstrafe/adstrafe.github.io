!function(){"use strict";var t,e,n,i,r,s,o,a,c={},l=[],u=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function h(t,e){for(var n in e)t[n]=e[n];return t}function _(t){var e=t.parentNode;e&&e.removeChild(t)}function f(e,n,i){var r,s,o,a={};for(o in n)"key"==o?r=n[o]:"ref"==o?s=n[o]:a[o]=n[o];if(arguments.length>2&&(a.children=arguments.length>3?t.call(arguments,2):i),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===a[o]&&(a[o]=e.defaultProps[o]);return d(e,a,r,s,null)}function d(t,i,r,s,o){var a={type:t,props:i,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++n:o};return null==o&&null!=e.vnode&&e.vnode(a),a}function y(t){return t.children}function p(t,e,n){"-"===e[0]?t.setProperty(e,null==n?"":n):t[e]=null==n?"":"number"!=typeof n||u.test(e)?n:n+"px"}function m(t,e,n,i,r){var s;t:if("style"===e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof i&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||p(t.style,e,"");if(n)for(e in n)i&&n[e]===i[e]||p(t.style,e,n[e])}else if("o"===e[0]&&"n"===e[1])s=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+s]=n,n?i||t.addEventListener(e,s?v:E,s):t.removeEventListener(e,s?v:E,s);else if("dangerouslySetInnerHTML"!==e){if(r)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==e&&"height"!==e&&"href"!==e&&"list"!==e&&"form"!==e&&"tabIndex"!==e&&"download"!==e&&e in t)try{t[e]=null==n?"":n;break t}catch(t){}"function"==typeof n||(null==n||!1===n&&-1==e.indexOf("-")?t.removeAttribute(e):t.setAttribute(e,n))}}function E(t){i=!0;try{return this.l[t.type+!1](e.event?e.event(t):t)}finally{i=!1}}function v(t){i=!0;try{return this.l[t.type+!0](e.event?e.event(t):t)}finally{i=!1}}function g(t,e){this.props=t,this.context=e}function k(t,e){if(null==e)return t.__?k(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?k(t):null}function A(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return A(t)}}function T(t){i?setTimeout(t):o(t)}function b(t){(!t.__d&&(t.__d=!0)&&r.push(t)&&!N.__r++||s!==e.debounceRendering)&&((s=e.debounceRendering)||T)(N)}function N(){var t,e,n,i,s,o,a,c;for(r.sort((function(t,e){return t.__v.__b-e.__v.__b}));t=r.shift();)t.__d&&(e=r.length,i=void 0,s=void 0,a=(o=(n=t).__v).__e,(c=n.__P)&&(i=[],(s=h({},o)).__v=o.__v+1,w(c,o,s,n.__n,void 0!==c.ownerSVGElement,null!=o.__h?[a]:null,i,null==a?k(o):a,o.__h),D(i,o),o.__e!=a&&A(o)),r.length>e&&r.sort((function(t,e){return t.__v.__b-e.__v.__b})));N.__r=0}function I(t,e,n,i,r,s,o,a,u,h){var _,f,p,m,E,v,g,A=i&&i.__k||l,T=A.length;for(n.__k=[],_=0;_<e.length;_++)if(null!=(m=n.__k[_]=null==(m=e[_])||"boolean"==typeof m?null:"string"==typeof m||"number"==typeof m||"bigint"==typeof m?d(null,m,null,null,m):Array.isArray(m)?d(y,{children:m},null,null,null):m.__b>0?d(m.type,m.props,m.key,m.ref?m.ref:null,m.__v):m)){if(m.__=n,m.__b=n.__b+1,null===(p=A[_])||p&&m.key==p.key&&m.type===p.type)A[_]=void 0;else for(f=0;f<T;f++){if((p=A[f])&&m.key==p.key&&m.type===p.type){A[f]=void 0;break}p=null}w(t,m,p=p||c,r,s,o,a,u,h),E=m.__e,(f=m.ref)&&p.ref!=f&&(g||(g=[]),p.ref&&g.push(p.ref,null,m),g.push(f,m.__c||E,m)),null!=E?(null==v&&(v=E),"function"==typeof m.type&&m.__k===p.__k?m.__d=u=S(m,u,t):u=R(t,m,p,A,E,u),"function"==typeof n.type&&(n.__d=u)):u&&p.__e==u&&u.parentNode!=t&&(u=k(p))}for(n.__e=v,_=T;_--;)null!=A[_]&&("function"==typeof n.type&&null!=A[_].__e&&A[_].__e==n.__d&&(n.__d=C(i).nextSibling),x(A[_],A[_]));if(g)for(_=0;_<g.length;_++)L(g[_],g[++_],g[++_])}function S(t,e,n){for(var i,r=t.__k,s=0;r&&s<r.length;s++)(i=r[s])&&(i.__=t,e="function"==typeof i.type?S(i,e,n):R(n,i,i,r,i.__e,e));return e}function R(t,e,n,i,r,s){var o,a,c;if(void 0!==e.__d)o=e.__d,e.__d=void 0;else if(null==n||r!=s||null==r.parentNode)t:if(null==s||s.parentNode!==t)t.appendChild(r),o=null;else{for(a=s,c=0;(a=a.nextSibling)&&c<i.length;c+=1)if(a==r)break t;t.insertBefore(r,s),o=s}return void 0!==o?o:r.nextSibling}function C(t){var e,n,i;if(null==t.type||"string"==typeof t.type)return t.__e;if(t.__k)for(e=t.__k.length-1;e>=0;e--)if((n=t.__k[e])&&(i=C(n)))return i;return null}function w(n,i,r,s,o,a,l,u,f){var d,p,E,v,A,T,b,N,S,R,C,w,D,L,x,P=i.type;if(void 0!==i.constructor)return null;null!=r.__h&&(f=r.__h,u=i.__e=r.__e,i.__h=null,a=[u]),(d=e.__b)&&d(i);try{t:if("function"==typeof P){if(N=i.props,S=(d=P.contextType)&&s[d.__c],R=d?S?S.props.value:d.__:s,r.__c?b=(p=i.__c=r.__c).__=p.__E:("prototype"in P&&P.prototype.render?i.__c=p=new P(N,R):(i.__c=p=new g(N,R),p.constructor=P,p.render=O),S&&S.sub(p),p.props=N,p.state||(p.state={}),p.context=R,p.__n=s,E=p.__d=!0,p.__h=[],p._sb=[]),null==p.__s&&(p.__s=p.state),null!=P.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=h({},p.__s)),h(p.__s,P.getDerivedStateFromProps(N,p.__s))),v=p.props,A=p.state,p.__v=i,E)null==P.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(null==P.getDerivedStateFromProps&&N!==v&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(N,R),!p.__e&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(N,p.__s,R)||i.__v===r.__v){for(i.__v!==r.__v&&(p.props=N,p.state=p.__s,p.__d=!1),i.__e=r.__e,i.__k=r.__k,i.__k.forEach((function(t){t&&(t.__=i)})),C=0;C<p._sb.length;C++)p.__h.push(p._sb[C]);p._sb=[],p.__h.length&&l.push(p);break t}null!=p.componentWillUpdate&&p.componentWillUpdate(N,p.__s,R),null!=p.componentDidUpdate&&p.__h.push((function(){p.componentDidUpdate(v,A,T)}))}if(p.context=R,p.props=N,p.__P=n,w=e.__r,D=0,"prototype"in P&&P.prototype.render){for(p.state=p.__s,p.__d=!1,w&&w(i),d=p.render(p.props,p.state,p.context),L=0;L<p._sb.length;L++)p.__h.push(p._sb[L]);p._sb=[]}else do{p.__d=!1,w&&w(i),d=p.render(p.props,p.state,p.context),p.state=p.__s}while(p.__d&&++D<25);p.state=p.__s,null!=p.getChildContext&&(s=h(h({},s),p.getChildContext())),E||null==p.getSnapshotBeforeUpdate||(T=p.getSnapshotBeforeUpdate(v,A)),x=null!=d&&d.type===y&&null==d.key?d.props.children:d,I(n,Array.isArray(x)?x:[x],i,r,s,o,a,l,u,f),p.base=i.__e,i.__h=null,p.__h.length&&l.push(p),b&&(p.__E=p.__=null),p.__e=!1}else null==a&&i.__v===r.__v?(i.__k=r.__k,i.__e=r.__e):i.__e=function(e,n,i,r,s,o,a,l){var u,h,f,d=i.props,y=n.props,p=n.type,E=0;if("svg"===p&&(s=!0),null!=o)for(;E<o.length;E++)if((u=o[E])&&"setAttribute"in u==!!p&&(p?u.localName===p:3===u.nodeType)){e=u,o[E]=null;break}if(null==e){if(null===p)return document.createTextNode(y);e=s?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,y.is&&y),o=null,l=!1}if(null===p)d===y||l&&e.data===y||(e.data=y);else{if(o=o&&t.call(e.childNodes),h=(d=i.props||c).dangerouslySetInnerHTML,f=y.dangerouslySetInnerHTML,!l){if(null!=o)for(d={},E=0;E<e.attributes.length;E++)d[e.attributes[E].name]=e.attributes[E].value;(f||h)&&(f&&(h&&f.__html==h.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}if(function(t,e,n,i,r){var s;for(s in n)"children"===s||"key"===s||s in e||m(t,s,null,n[s],i);for(s in e)r&&"function"!=typeof e[s]||"children"===s||"key"===s||"value"===s||"checked"===s||n[s]===e[s]||m(t,s,e[s],n[s],i)}(e,y,d,s,l),f)n.__k=[];else if(E=n.props.children,I(e,Array.isArray(E)?E:[E],n,i,r,s&&"foreignObject"!==p,o,a,o?o[0]:i.__k&&k(i,0),l),null!=o)for(E=o.length;E--;)null!=o[E]&&_(o[E]);l||("value"in y&&void 0!==(E=y.value)&&(E!==e.value||"progress"===p&&!E||"option"===p&&E!==d.value)&&m(e,"value",E,d.value,!1),"checked"in y&&void 0!==(E=y.checked)&&E!==e.checked&&m(e,"checked",E,d.checked,!1))}return e}(r.__e,i,r,s,o,a,l,f);(d=e.diffed)&&d(i)}catch(n){i.__v=null,(f||null!=a)&&(i.__e=u,i.__h=!!f,a[a.indexOf(u)]=null),e.__e(n,i,r)}}function D(t,n){e.__c&&e.__c(n,t),t.some((function(n){try{t=n.__h,n.__h=[],t.some((function(t){t.call(n)}))}catch(t){e.__e(t,n.__v)}}))}function L(t,n,i){try{"function"==typeof t?t(n):t.current=n}catch(t){e.__e(t,i)}}function x(t,n,i){var r,s;if(e.unmount&&e.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||L(r,null,n)),null!=(r=t.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(t){e.__e(t,n)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(s=0;s<r.length;s++)r[s]&&x(r[s],n,i||"function"!=typeof t.type);i||null==t.__e||_(t.__e),t.__=t.__e=t.__d=void 0}function O(t,e,n){return this.constructor(t,n)}function P(t,e){var n={__c:e="__cC"+a++,__:t,Consumer:function(t,e){return t.children(e)},Provider:function(t){var n,i;return this.getChildContext||(n=[],(i={})[e]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&n.some((function(t){t.__e=!0,b(t)}))},this.sub=function(t){n.push(t);var e=t.componentWillUnmount;t.componentWillUnmount=function(){n.splice(n.indexOf(t),1),e&&e.call(t)}}),t.children}};return n.Provider.__=n.Consumer.contextType=n}t=l.slice,e={__e:function(t,e,n,i){for(var r,s,o;e=e.__;)if((r=e.__c)&&!r.__)try{if((s=r.constructor)&&null!=s.getDerivedStateFromError&&(r.setState(s.getDerivedStateFromError(t)),o=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(t,i||{}),o=r.__d),o)return r.__E=r}catch(e){t=e}throw t}},n=0,i=!1,g.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=h({},this.state),"function"==typeof t&&(t=t(h({},n),this.props)),t&&h(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),b(this))},g.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),b(this))},g.prototype.render=y,r=[],o="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,N.__r=0,a=0;let M=class extends Error{code;isIntlError=!0;constructor(t,e){super(`${t} ${e}`),this.code=t}static FORMAT_UNAVAILABLE="FormatUnavailable";static INVALID_PARAMETER="InvalidParameter";static KEY_NOT_FOUND="KeyNotFound";static PARSE_ERROR="KeyNotFound";static is(t){return!0===t?.isIntlError}};function q(t,e,n){for(const i in t){if(i.startsWith("$"))continue;const r=t[i];switch(typeof r){case"string":e[n+i]=r;break;case"object":null!==r&&q(r,e,`${n}${i}.`)}}return e}function F(t){return q(t,{},"")}function H(t,e){const n={};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const r=e(t[i],i);null!=r&&(n[i]=r)}return n}function G(t){return t[1]??"variable"}function K(t,e){const n=t[0];return void 0!==e&&Object.prototype.hasOwnProperty.call(e,n)?""+e[n]:n}function U(t,e){const{length:n}=e,i=G(t);if(t.length-2>n)throw new M(M.INVALID_PARAMETER,`too many parameters for format '${i}'`);for(let r=0;r<n;++r)e[r].call(null,t[2+r],i,r)}function V(t,e,n){throw new M(M.INVALID_PARAMETER,`expected parameter ${n+1} of format '${e}' to be ${t}`)}const $={y(t,e){let n=t.getFullYear();return 2===e&&(n%=100),B(n,e)},M(t,e,{monthsLong:n,monthsShort:i}){const r=t.getMonth();switch(e){case 1:case 2:return B(r+1,e);case 3:return Y(i),i[r];case 4:return Y(n),n[r];default:throw Q()}},d:(t,e)=>B(t.getDate(),e),E(t,e,{weekdaysLong:n,weekdaysShort:i}){const r=t.getDay();switch(e){case 1:case 2:case 3:return Y(i),i[r];case 4:return Y(n),n[r];default:throw Q()}},a:(t,e,{dayPeriod:n})=>(Y(n),n[t.getHours()>=12?1:0]),h(t,e){const n=t.getHours()%12;return B(0===n?12:n,e)},H:(t,e)=>B(t.getHours(),e),m:(t,e)=>B(t.getMinutes(),e),s:(t,e)=>B(t.getSeconds(),e),X(t,e){const n=t.getTimezoneOffset();if(0===n)return"Z";const i=Math.floor(Math.abs(n)/60),r=Math.abs(n)%60;return(n<0?"-":"+")+B(i)+(0!==r||e>1?(e>2?":":"")+B(r):"")}};function Y(t){if(null==t)throw new M(M.FORMAT_UNAVAILABLE,"Cannot use some DateTime formats; Required translations are missing.")}function Q(){return new M(M.FORMAT_UNAVAILABLE,"DateTime format not supported.")}function B(t,e=2){return(""+t).padStart(e,"0")}function W(t,e,n){let i;switch(typeof e){case"number":case"string":i=new Date(e);break;case"object":if(null!==e&&e instanceof Date){i=e;break}default:throw new M(M.INVALID_PARAMETER,"invalid date")}let r,s="",o=0;for(;o<t.length;)r=t[o++],s+="function"==typeof r?r(i,t[o++],n):r;return s}function z(t){const e=[],{length:n}=t;if(0===n)return()=>"";let i=0,r=0,s=!1,o=t.charCodeAt(0);const a=t=>{const n=e.length-1;n>=0&&"string"==typeof e[n]?e[n]+=t:e.push(t)},c=()=>{const n=t.slice(r,i);if(s)a(n||"'");else if(o>=65&&o<=90||o>=97&&o<=122){const t=$[n[0]];t&&e.push(t,n.length)}else a(n);r=i};for(;i<n;){const e=t.charCodeAt(i);39===e?(c(),39===t.charCodeAt(i+1)?(a("'"),r+=2,++i):(s=!s,++r)):s||e===o||c(),o=e,++i}return c(),W.bind(null,e)}const j=[function(t,e,n){"string"!=typeof t&&V("an identifier",e,n)}],J=t=>{const e=H(t.formats,z);return n=>{U(n,j);const i=e[n[2]];if(!i)throw new M(M.INVALID_PARAMETER,`DateTime format '${n[2]}' is not configured.`);return e=>i(K(n,e),t)}},X=[function(t,e,n){(function(t){return null!==t&&"object"==typeof t})(t)&&Array.isArray(function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}(t))||V("a map of messages",e,n)}],Z=[],tt={select:()=>(t,e)=>{U(t,X);const n=t[2];if(!n.other)throw new M(M.INVALID_PARAMETER,`messages of format '${G(t)}' must contain the key 'other'`);const i={};for(const t in n)i[t]=e.interpret(n[t]);return e=>(i[K(t,e)]??i.other)(e)},variable:()=>t=>(U(t,Z),e=>K(t,e)),date:J,time:J};class et extends M{input;at;constructor(t,e,n){super(M.PARSE_ERROR,t),this.input=e,this.at=n}toString(){const t=Math.max(this.input.lastIndexOf("\n",this.at-1),0)+1;let e=this.input.indexOf("\n",this.at+1);-1===e?e=this.input.length:"\r"===this.input[e-1]&&--e;const n=`${this.input.slice(t,e)}\n${" ".repeat(this.at-t)}^`;return`${this.message} at pos ${this.at}:\n\n${n}\n\n${this.stack}`}}function nt(t){return 32===t||t>=9&&t<=13||133===t||160===t||6158===t||t>=8192&&t<=8205||8232===t||8233===t||8239===t||8287===t||8288===t||12288===t||65279===t}function it(t,e){const{length:n}=t;let i=e;for(;i<n&&nt(t.charCodeAt(i));)++i;return i}function rt(t,e){const{length:n}=t;let i,r=e;for(;r<n&&(i=t[r],"{"!==i&&"}"!==i&&","!==i&&"#"!==i&&"'"!==i&&":"!==i&&!nt(i.charCodeAt(0)));)++r;if(e===r)throw new et(`expected an identifier but ${i?`saw '${i}'`:"saw the end of pattern"} instead`,t,e);return t.slice(e,r)}function st(t,e,n){const{length:i}=t;let r,s=e,o=e,a="";for(;o<i&&(r=t[o],!("{"===r||"}"===r||n&&"#"===r));){if("'"===r)if(r=t[++o],"'"===r)a+=t.slice(s,o),s=o+1;else if("{"===r||"}"===r||n&&"#"===r){for(a+=t.slice(s,o-1),s=o;++o<i;)if(r=t[o],"'"===r){if(r=t[o+1],"'"!==r)break;a+=t.slice(s,++o),s=o+1}a+=t.slice(s,o),s=++o}++o}return a+=t.slice(s,o),a}function ot(t,e,n,i){const{length:r}=t,s={};n.push(s);let o,a=i,c=[],l=lt(t,e,c,!0);for(s[a]=c;l<r&&(l=it(t,l),o=t[l],","!==o&&"}"!==o);){if(a=rt(t,l),l=it(t,l+a.length),o=t[l],"{"!==o)throw new et("expected '{'",t,l);c=[],l=lt(t,l+1,c,!0),s[a]=c}return l}function at(t,e,n,i){const{length:r}=t,s={};n.push(s);let o,a=i,c=it(t,e),l=rt(t,c);for(c+=l.length,s[a]=l;c<r&&(c=it(t,c),o=t[c],","!==o&&"}"!==o);){if(a=rt(t,c),c=it(t,c+a.length),o=t[c],"{"===o)return ot(t,c+1,n,a);if(":"!==o)throw new et("expected ':' or '{'",t,c);c=it(t,c+1),l=rt(t,c),c+=l.length,s[a]=l}return c}function ct(t,e,n){let i=e,r=t[i];if("#"===r)return n.push("#"),i+1;if("{"!==r)throw new et("expected '#' or '{'",t,i);const{length:s}=t;do{i=it(t,i+1);const e=rt(t,i);switch(i=it(t,i+e.length),r=t[i],r){case",":case"}":n.push(e);break;case"{":if(n.length<2)throw new et("expected an identifier but saw a message instead",t,i);i=ot(t,i+1,n,e),r=t[i];break;case":":if(n.length<2)throw new et("expected an identifier but saw an attribute instead",t,i);i=at(t,i+1,n,e),r=t[i];break;default:throw new et(`unexpected character '${r}'`,t,i)}}while(i<s&&"}"!==r);return i+1}function lt(t,e,n,i){let r,s=e,o=st(t,s,i);o&&(n.push(o),s+=o.length);const{length:a}=t;for(;s<a;){if(r=t[s],"}"===r){if(!i)throw new et("unexpected '}'",t,s);++s;break}const e=[];s=ct(t,s,e),n.push(e),o=st(t,s,i),o&&(n.push(o),s+=o.length)}return s}function ut(t){const e=[];return lt(t,0,e,!1),e}class ht{formatProvider;constructor(t){this.formatProvider=t}interpret(t,e){const{length:n}=t;if(1===n)return this.interpretElement(t[0],e);const i=new Array(n);for(let r=0;r<n;++r)i[r]=this.interpretElement(t[r],e);return _t.bind(null,i)}interpretElement(t,e){if("string"==typeof t)return()=>t;let n=t;if(1===n.length&&"#"===n[0]){if(void 0===e)return()=>"#";n=[e]}return this.formatProvider.getFormat(n)(n,this)}}function _t(t,e){let n="";for(let i=0;i<t.length;++i)n+=t[i](e);return n}class ft{formatMap;constructor(t){this.formatMap=t}getFormat(t){const e=G(t),n=this.formatMap[e];if(!n)throw new M(M.FORMAT_UNAVAILABLE,e);return n}}var dt;!function(t){t[t.Eager=0]="Eager",t[t.Lazy=1]="Lazy",t[t.Off=2]="Off"}(dt||(dt={}));class yt{cacheMode;expansions;interpreter;constructor({cacheMode:t,interpreter:e,translations:n}){this.cacheMode=t??dt.Lazy,this.interpreter=e,this.expansions=F(n),t===dt.Eager&&(this.expansions=H(this.expansions,(t=>e.interpret(ut(t)))))}expand(t,e){let n=this.expansions[t];if(void 0===n)throw new M(M.KEY_NOT_FOUND,t);return"string"==typeof n&&(n=this.interpreter.interpret(ut(n)),this.cacheMode!==dt.Off&&(this.expansions[t]=n)),n(e)}static fromLocale(t,e=tt){const n=H(e,((e,n)=>{const i=t.$format?.[n];return!i&&e.length>0?null:e(t.$format?.[n])})),i=new ft(n);return new yt({cacheMode:dt.Lazy,interpreter:new ht(i),translations:t})}}var pt,mt,Et,vt,gt=0,kt=[],At=[],Tt=e.__b,bt=e.__r,Nt=e.diffed,It=e.__c,St=e.unmount;function Rt(t,n){e.__h&&e.__h(mt,t,gt||n),gt=0;var i=mt.__H||(mt.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({__V:At}),i.__[t]}function Ct(t){return gt=1,wt(Gt,t)}function wt(t,e,n){var i=Rt(pt++,2);if(i.t=t,!i.__c&&(i.__=[n?n(e):Gt(void 0,e),function(t){var e=i.__N?i.__N[0]:i.__[0],n=i.t(e,t);e!==n&&(i.__N=[n,i.__[1]],i.__c.setState({}))}],i.__c=mt,!mt.u)){mt.u=!0;var r=mt.shouldComponentUpdate;mt.shouldComponentUpdate=function(t,e,n){if(!i.__c.__H)return!0;var s=i.__c.__H.__.filter((function(t){return t.__c}));if(s.every((function(t){return!t.__N})))return!r||r.call(this,t,e,n);var o=!1;return s.forEach((function(t){if(t.__N){var e=t.__[0];t.__=t.__N,t.__N=void 0,e!==t.__[0]&&(o=!0)}})),!(!o&&i.__c.props===t)&&(!r||r.call(this,t,e,n))}}return i.__N||i.__}function Dt(t,n){var i=Rt(pt++,3);!e.__s&&Ht(i.__H,n)&&(i.__=t,i.i=n,mt.__H.__h.push(i))}function Lt(t,e){var n=Rt(pt++,7);return Ht(n.__H,e)?(n.__V=t(),n.i=e,n.__h=t,n.__V):n.__}function xt(t){var e=mt.context[t.__c],n=Rt(pt++,9);return n.c=t,e?(null==n.__&&(n.__=!0,e.sub(mt)),e.props.value):t.__}function Ot(){for(var t;t=kt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(qt),t.__H.__h.forEach(Ft),t.__H.__h=[]}catch(n){t.__H.__h=[],e.__e(n,t.__v)}}e.__b=function(t){mt=null,Tt&&Tt(t)},e.__r=function(t){bt&&bt(t),pt=0;var e=(mt=t.__c).__H;e&&(Et===mt?(e.__h=[],mt.__h=[],e.__.forEach((function(t){t.__N&&(t.__=t.__N),t.__V=At,t.__N=t.i=void 0}))):(e.__h.forEach(qt),e.__h.forEach(Ft),e.__h=[])),Et=mt},e.diffed=function(t){Nt&&Nt(t);var n=t.__c;n&&n.__H&&(n.__H.__h.length&&(1!==kt.push(n)&&vt===e.requestAnimationFrame||((vt=e.requestAnimationFrame)||Mt)(Ot)),n.__H.__.forEach((function(t){t.i&&(t.__H=t.i),t.__V!==At&&(t.__=t.__V),t.i=void 0,t.__V=At}))),Et=mt=null},e.__c=function(t,n){n.some((function(t){try{t.__h.forEach(qt),t.__h=t.__h.filter((function(t){return!t.__||Ft(t)}))}catch(i){n.some((function(t){t.__h&&(t.__h=[])})),n=[],e.__e(i,t.__v)}})),It&&It(t,n)},e.unmount=function(t){St&&St(t);var n,i=t.__c;i&&i.__H&&(i.__H.__.forEach((function(t){try{qt(t)}catch(t){n=t}})),i.__H=void 0,n&&e.__e(n,i.__v))};var Pt="function"==typeof requestAnimationFrame;function Mt(t){var e,n=function(){clearTimeout(i),Pt&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,100);Pt&&(e=requestAnimationFrame(n))}function qt(t){var e=mt,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),mt=e}function Ft(t){var e=mt;t.__c=t.__(),mt=e}function Ht(t,e){return!t||t.length!==e.length||e.some((function(e,n){return e!==t[n]}))}function Gt(t,e){return"function"==typeof e?e(t):e}function Kt(t){return"⚠️ "+t}const Ut={isLoading:!0,t:()=>""},Vt={isLoading:!1,t:()=>Kt("LocaleFetchError")},$t=P(Ut);function Yt(){return xt($t)}class Qt extends g{state=Ut;pendingFetch;componentDidMount(){this.fetchLocale()}componentDidUpdate(t){const e=this.props;t.url!==e.url&&this.fetchLocale()}componentWillUnmount(){this.pendingFetch?.abort()}render(){return f($t.Provider,{children:this.props.children,value:this.state})}async fetchLocale(){try{this.setState(Ut),this.pendingFetch=new AbortController;const t=await fetch(this.props.url,{credentials:this.props.fetchCredentials,headers:this.props.fetchHeaders,method:"GET",signal:this.pendingFetch.signal});if(!t.ok)throw new Error(`unexpected HTTP response ${t.status} - ${t.statusText}`);const e=await t.json(),n=yt.fromLocale(e,this.props.formats);this.setState({isLoading:!1,t:Bt.bind(null,n)})}catch(t){this.setState(Vt),this.props.onError?.(t)}finally{this.pendingFetch=void 0}}}function Bt(t,e,n,i){let r,s,o;if("string"==typeof e)r=e,"string"==typeof n?o=n:(s=n,o=i);else{if(function(t){return"string"==typeof t.text}(e))return e.text;r=e.key,s=e.vars,o=e.fallbackText}try{return t.expand(r,s)}catch(t){return void 0===o?Kt(M.is(t)?t.message:"UnknownError"):o}}function Wt(t,e){let n=t;for(const i in e)e[i]&&(n+=` ${t}--${i}`);return n}function zt(){const{length:t}=arguments;let e="";for(let n,i=0;i<t;++i)(n=arguments[i])&&(e+=(e&&" ")+n);return e}const jt=t=>f("button",{...t,class:zt(Wt("button",{disabled:t.disabled,selected:t.selected}),t.class),type:t.type??"button"});var Jt;!function(t){t.Horizontal="horizontal",t.Vertical="vertical"}(Jt||(Jt={}));const Xt=({class:t,footer:e,header:n,itemRenderer:i,items:r,orientation:s=Jt.Vertical,uniform:o=!1})=>f("div",{class:zt(Wt("menu",{horizontal:s===Jt.Horizontal,vertical:s===Jt.Vertical,uniform:o}),t)},n,r.map(i),e),Zt=P(null);function te(){return xt(Zt)}const ee=({initialPath:t,routes:e})=>{const{t:n}=Yt(),[i,r]=Ct((()=>{const n=void 0===t?void 0:e.find((e=>e.path===t));return{route:n??e[0],params:null}})),s=(t,n)=>{const i=e.find((e=>e.path===t));if(!i)throw new Error(`No route with path '${t}' exists.`);r({route:i,params:n})};return f(y,null,f("div",{class:"app-router__content"},f("div",{class:"app-router__container"},f(Zt.Provider,{value:{...i,navigate:s}},f(i.route.content,{})))),f("div",{class:"app-router__menu"},f(Xt,{class:"app-router__container",orientation:Jt.Horizontal,items:e.filter((t=>!0===t.visible)),itemRenderer:({path:t})=>f(jt,{key:t,selected:t===i.route.path,children:n(`ui.route.${t}`),onClick:()=>s(t)}),uniform:!0})))};class ne{debounceMs;key;storage;debounceHandle;isInitialized=!1;state;constructor(t){this.debounceMs=t.debounceMs??50,this.key=t.key,this.storage=t.storage??window.localStorage}get(){if(!this.isInitialized){const t=this.storage.getItem(this.key);if(!t)throw new Error(`key '${this.key}' not found within the storage`);this.state=JSON.parse(t),this.isInitialized=!0}return this.state}set(t,e=!1){void 0!==this.debounceHandle&&clearTimeout(this.debounceHandle),this.state=t;const n=()=>{this.debounceHandle=void 0;try{this.storage.setItem(this.key,JSON.stringify(t)),this.isInitialized=!0}catch(t){console.error("Failed to store state:",t)}};e?n():this.debounceHandle=setTimeout(n,this.debounceMs)}}class ie{backend;path;isProxyBackend=!0;constructor(t,e){this.backend=t,this.path=e}get(){let t=this.backend.get(),e=0;for(;e<this.path.length;){if("object"!=typeof t||null===t)throw new Error("Primitive types cannot hold sub-states.");const n=this.path[e++];if("number"!=typeof n&&Array.isArray(t))throw new Error("Cannot access array sub-state under non-numeric keys.");t=t[n]}return t}set(t,e){let n=this.backend.get(),i=0;const r=Array.isArray(n)?n.slice():{...n};for(n=r;i<this.path.length;){if("object"!=typeof n||null===n)throw new Error("Primitive types cannot hold sub-states.");const e=this.path[i++];if("number"!=typeof e&&Array.isArray(n))throw new Error("Cannot access array sub-state under non-numeric keys.");if(i===this.path.length)n[e]=t;else{const t=n[e],i=Array.isArray(t)?t.slice():{...t};n[e]=i,n=i}}this.backend.set(r,e)}static proxySubState(t,e){return ie.isProxy(t)?new ie(t.backend,t.path.concat(e)):new ie(t,[e])}static isProxy(t){return t.isProxyBackend}}class re{backend;constructor(t){this.backend=t}get current(){return this.backend.get()}init(t){try{return this.backend.get(),!1}catch(e){return this.set(t,!0),!0}}set(t,e){this.backend.set(t,e)}patch(t,e){this.set({...this.current,...t},e)}subState(t){return new re(ie.proxySubState(this.backend,t))}}class se{entries={};get keys(){return Object.keys(this.entries)}add(t){if(this.entries[t.key])throw new Error(`Entry with the key '${t.key}' has already been registered.`);return this.entries[t.key]=t,t}get(t){const e=this.entries[t];if(!e)throw new Error(`Entry with the key '${t}' has not been registered.`);return e}}class oe{state;_value;constructor(t){this.state=t}get xp(){return this.state.current}set xp(t){Number.isFinite(t)&&t>=0&&(this.state.set(t),this._value=void 0)}get value(){return this._value??=oe.getLevelByExperience(this.xp)}get xpRequiredForNextLevel(){return oe.getExperienceRequiredForLevel(this.value+1)-oe.getExperienceRequiredForLevel(this.value)}get xpThisLevel(){return this.xp-oe.getExperienceRequiredForLevel(this.value)}static getExperienceRequiredForLevel(t){return Math.ceil(1e3*(1.2**(Math.floor(t)-1)-1))}static getLevelByExperience(t){return 1+Math.floor(Math.log(1+t/1e3)/Math.log(1.2))}}var ae,ce;!function(t){t[t.IDLE=0]="IDLE",t[t.CRAFT_PENDING=1]="CRAFT_PENDING",t[t.CRAFT_READY=2]="CRAFT_READY"}(ae||(ae={}));class le{game;state;level;constructor(t,e){this.game=t,this.state=e,this.level=new oe(e.subState("xp"))}get activity(){return this.state.current.activity}get entry(){return le.registry.get(this.key)}get icon(){return this.entry.icon}get key(){return this.state.current.key}get recipes(){return this.entry.recipes}scheduleCraft(t,e){if(this.activity.kind!==ae.IDLE)throw new Error("Cannot schedule a craft when the crafter is not IDLE.");const n=this.entry.recipes.indexOf(t);if(-1===n)throw new Error("Crafter can only craft its own recipes.");this.game.inventory.remove(t.materials.map((t=>({...t,quantity:t.quantity*e})))),this.state.patch({activity:{kind:ae.CRAFT_PENDING,elapsesAt:this.game.clock.now+t.baseDurationMs*e,recipeIndex:n,quantity:e}})}completeCraft(){if(this.activity.kind!==ae.CRAFT_PENDING||this.activity.elapsesAt>this.game.clock.now)throw new Error("Cannot complete a craft when it did not elapse.");const{result:t}=this.entry.recipes[this.activity.recipeIndex];this.state.patch({activity:{kind:ae.CRAFT_READY,loot:{...t,quantity:t.quantity*this.activity.quantity},xp:0*this.activity.quantity}})}deliverCraft(){if(this.activity.kind!==ae.CRAFT_READY)throw new Error("Cannot deliver a craft when not ready.");this.game.inventory.add([this.activity.loot]),this.level.xp+=this.activity.xp,this.state.patch({activity:{kind:ae.IDLE}})}static registry=new se;static create(t){return{key:t,xp:0,activity:{kind:ae.IDLE}}}}!function(t){t[t.WEAPON=0]="WEAPON",t[t.HEAD=1]="HEAD",t[t.CHEST=2]="CHEST",t[t.LEGS=3]="LEGS",t[t.FEET=4]="FEET",t[t.RING=5]="RING"}(ce||(ce={}));const ue=[ce.WEAPON,ce.HEAD,ce.CHEST,ce.LEGS,ce.FEET,ce.RING];var he;function _e(){return t=>(Object.keys(t).forEach((e=>{t[e].key??=e})),t)}function fe(t,e){const n=t[e];if("object"!=typeof n||n.key!==e)throw new Error(`No enum member with the key '${e}' found.`);return n}!function(t){t[t.AGILITY=0]="AGILITY",t[t.INTELLECT=1]="INTELLECT",t[t.STAMINA=2]="STAMINA",t[t.STRENGTH=3]="STRENGTH",t[t.PHYSICAL_DEFENSE=4]="PHYSICAL_DEFENSE",t[t.MAGIC_DEFENSE=5]="MAGIC_DEFENSE"}(he||(he={}));const de=_e()({BONE:{icon:"🦴",sellPrice:5,maxStack:20},SKULL:{icon:"💀",sellPrice:8,maxStack:20},BROKEN_BOW:{icon:"🏹",sellPrice:5,maxStack:20},WOODEN_LOG:{icon:"🪵",sellPrice:1,maxStack:100},STONE:{icon:"🗿",sellPrice:1,maxStack:100},BERRY:{icon:"🫐",sellPrice:3,maxStack:50},COCA_LEAVES:{icon:"🌿",sellPrice:30,maxStack:50},SWORD:{icon:"🗡️",sellPrice:15,maxStack:1,slot:ce.WEAPON,attributes:{[he.STRENGTH]:3}},MARTINUV_GLOSAR:{icon:"📖",sellPrice:15,maxStack:1,slot:ce.WEAPON,attributes:{[he.STAMINA]:20,[he.STRENGTH]:10}},STAFF:{icon:"🍢",sellPrice:15,maxStack:1,slot:ce.WEAPON,attributes:{[he.INTELLECT]:3}},HEALTH_POTION:{icon:"🧪",sellPrice:10,maxStack:20,healValue:20},COCAINE:{icon:"❄️",sellPrice:1e3,maxStack:20,healValue:-20},CHAIN_HOOD:{icon:"🪖",sellPrice:5,maxStack:1,slot:ce.HEAD,attributes:{[he.PHYSICAL_DEFENSE]:2}},CHAIN_VEST:{icon:"🎽",sellPrice:5,maxStack:1,slot:ce.CHEST,attributes:{[he.PHYSICAL_DEFENSE]:2}},CHAIN_LEGGINGS:{icon:"👖",sellPrice:5,maxStack:1,slot:ce.LEGS,attributes:{[he.PHYSICAL_DEFENSE]:2}},APPRENTICE_RING:{icon:"💍",sellPrice:5,maxStack:1,slot:ce.RING,attributes:{[he.STAMINA]:3}}});function ye(t,e){let n=0;for(const i of t)n+=e(i);return n}function pe(t,e){return void 0===e?t[0]:t.slice(0,Math.max(e,0))}function me(t,e=0,n=1){return t>n?n:t<e?e:t}function Ee(t,e){return n=Math.random(),(e-(i=t))*n+i;var n,i}function ve(t,e){return Math.trunc(Ee(t,e))}class ge{rows;constructor(t){this.rows=t}generateLoot(){const t=this.chooseRow(),e=[];for(const n of t.items){const t=ve(n.minQuantity,n.maxQuantity+1);t>0&&e.push({itemKey:n.itemKey,quantity:t})}return e}chooseRow(){let t=Ee(0,ye(this.rows,(t=>t.probability)));for(const e of this.rows)if(t-=e.probability,t<=0)return e;return ge.EMPTY_ROW}static EMPTY_ROW={items:[],probability:0};static generateLoot(t){return new ge(t).generateLoot()}}const ke=new se;var Ae,Te,be;!function(t){t[t.GOOD=0]="GOOD",t[t.EVIL=1]="EVIL"}(Ae||(Ae={})),function(t){t[t.CONST=0]="CONST",t[t.OFFSET=1]="OFFSET",t[t.MULTIPLIER=2]="MULTIPLIER"}(Te||(Te={})),function(t){t[t.POSITIVE=0]="POSITIVE",t[t.NEGATIVE=1]="NEGATIVE"}(be||(be={}));const Ne=_e()({SUNDER:{kind:be.NEGATIVE,duration:3,maxStackCount:5,tick(t){t.setAttribute(he.PHYSICAL_DEFENSE,.93**this.stackCount,Te.MULTIPLIER)}},IGNITE:{kind:be.NEGATIVE,duration:3,maxStackCount:0,tick(t){t.damage(this.param/6)}}}),Ie=(t,e)=>pe(function(t,e){switch(t.side){case Ae.GOOD:return e.evil;case Ae.EVIL:return e.good}}(t,e));const Se=_e()({NONE:{execute(){}},LUNGE:{execute(t,e){const n=Ie(t,e),i=t.getAttribute(he.STRENGTH)*Ee(.9,1.1);n.damage(i,he.PHYSICAL_DEFENSE)}},FIREBALL:{execute(t,e){const n=Ie(t,e),i=t.getAttribute(he.INTELLECT)*Ee(.9,1.1);n.damage(i,he.MAGIC_DEFENSE),n.addEffect(Ne.IGNITE,i)}},SUNDER:{execute(t,e){Ie(t,e).addEffect(Ne.SUNDER)}}});var Re,Ce,we;!function(t){t[t.DIRECT_DAMAGE=0]="DIRECT_DAMAGE",t[t.DIRECT_HEAL=1]="DIRECT_HEAL",t[t.EFFECT_APPLIED=2]="EFFECT_APPLIED",t[t.EFFECT_STACKED=3]="EFFECT_STACKED",t[t.EFFECT_FADED=4]="EFFECT_FADED",t[t.EFFECT_REMOVED=5]="EFFECT_REMOVED",t[t.PARTICIPANT_DIED=6]="PARTICIPANT_DIED",t[t.PARTICIPANT_REVIVED=7]="PARTICIPANT_REVIVED",t[t.ROUND_START=8]="ROUND_START"}(Re||(Re={}));class De{simulator;entity;side;_effects=[];attributeOverrides={};constructor(t,e,n){this.simulator=t,this.entity=e,this.side=n}get effects(){return this._effects}get health(){return this.entity.health.value}get isAlive(){return this.entity.health.isAlive}damage(t,e){const n=void 0===e?0:this.getAttribute(e),i=Math.max(t,0)*(1/(1+n/11)),r=this.setHealth(-i);0!==r&&(this.simulator.report({kind:Re.DIRECT_DAMAGE,healthChange:r,source:this.simulator.currentAttacker,target:this}),this.isAlive||(this._effects=[],this.simulator.report({kind:Re.PARTICIPANT_DIED,target:this})))}heal(t){const e=!this.isAlive,n=this.setHealth(Math.max(t,0));0!==n&&(this.simulator.report({kind:Re.DIRECT_HEAL,healthChange:n,source:this.simulator.currentAttacker,target:this}),e&&this.simulator.report({kind:Re.PARTICIPANT_REVIVED,revivalHealth:n,target:this}))}getAttribute(t){return this.attributeOverrides[t]??this.entity.getAttribute(t)}setAttribute(t,e,n=Te.CONST){let i;switch(n){case Te.CONST:i=e;break;case Te.OFFSET:i=this.getAttribute(t)+e;break;case Te.MULTIPLIER:i=this.getAttribute(t)*e}this.attributeOverrides[t]=i}addEffect(t,e=0){if(this.isAlive){if(t.maxStackCount>0){const e=this._effects.find((e=>e.effectKey===t.key&&e.source===this.simulator.currentAttacker));if(e)return e.remainingDuration=t.duration,e.stackCount=Math.min(e.stackCount+1,t.maxStackCount),void this.simulator.report({kind:Re.EFFECT_STACKED,effectKey:t.key,source:this.simulator.currentAttacker,target:this,stackCount:e.stackCount})}this._effects.push({effectKey:t.key,param:e,source:this.simulator.currentAttacker,remainingDuration:t.duration,stackCount:1}),this.simulator.report({kind:Re.EFFECT_APPLIED,effectKey:t.key,source:this.simulator.currentAttacker,target:this})}}removeEffect(t){const e=this._effects.indexOf(t);if(-1!==e){const t=this._effects[e];this._effects.splice(e,1),this.simulator.report({kind:Re.EFFECT_REMOVED,effectKey:t.effectKey,target:this})}}tickEffects(){this.attributeOverrides={};let t=0;for(;t<this._effects.length;){const e=this._effects[t];0!==e.remainingDuration?(--e.remainingDuration,this.simulator.runEffect(this,e),++t):(this._effects.splice(t,1),this.simulator.report({kind:Re.EFFECT_FADED,effectKey:e.effectKey,target:this}))}}setHealth(t){const e=this.entity.health.value;this.entity.health.value=e+t;const n=this.entity.health.value-e;return Math.abs(n)<Number.EPSILON?0:n}}class Le{participants;events=[];allParticipants;_currentAttacker;constructor(t){this.allParticipants=t.map((t=>new De(this,t.entity,t.side)));const e=[],n=[];for(const t of this.allParticipants)switch(t.side){case Ae.GOOD:n.push(t);break;case Ae.EVIL:e.push(t)}this.participants={evil:e,good:n}}get currentAttacker(){return this._currentAttacker}run(){let t,e=0;do{this.report({kind:Re.ROUND_START,round:e+1});for(const t of this.allParticipants){if(!t.isAlive)continue;const{rotation:n}=t.entity,i=n[e%n.length];this.runAttack(t,i),t.tickEffects()}if(100==++e)break}while((t=this.participants.good.some(xe))&&this.participants.evil.some(xe));if(t){let t=this.participants.good.some(Oe);for(;t;){this.report({kind:Re.ROUND_START,round:e+1}),t=!1;for(const e of this.participants.good)Oe(e)&&(e.tickEffects(),t=!0);if(150==++e)break}}return this.events}runAttack(t,e){const n=fe(Se,e);this._currentAttacker=t,n.execute(t,this.participants)}runEffect(t,e){const n=fe(Ne,e.effectKey);this._currentAttacker=e.source,n.tick.call(e,t)}report(t){this.events.push(t)}static create(t){return new Le(t)}}function xe(t){return t.isAlive}function Oe(t){return t.isAlive&&t.effects.length>0}class Pe{state;constructor(t){this.state=t}get(){return this.state}set(t){this.state=t}}class Me{owner;state;constructor(t,e){this.owner=t,this.state=e}get value(){return this.maxHealth-this.state.current}set value(t){this.state.set(me(this.maxHealth-t,0,this.maxHealth))}get isAlive(){return this.value>0}get maxHealth(){return 100+5*this.owner.getAttribute(he.STAMINA)}reset(){this.state.set(0)}}class qe{key;health;info;constructor(t){this.key=t,this.info=qe.registry.get(t),this.health=new Me(this,new re(new Pe(0)))}get rotation(){return this.info.rotation}getAttribute(t){return this.info.attributes[t]??0}static registry=new se}!function(t){t[t.IDLE=0]="IDLE",t[t.DEAD=1]="DEAD",t[t.QUEST_PENDING=2]="QUEST_PENDING",t[t.QUEST_READY=3]="QUEST_READY"}(Ce||(Ce={}));class Fe{game;state;health;level;constructor(t,e){this.game=t,this.state=e,this.health=new Me(this,e.subState("healthDeficit")),this.level=new oe(e.subState("xp"))}get activity(){return this.state.current.activity}get entry(){return Fe.registry.get(this.key)}get equipment(){return this.state.current.equipment}get icon(){return this.entry.icon}get key(){return this.state.current.key}get rotation(){return this.state.current.rotation}set rotation(t){this.state.patch({rotation:t})}getAttribute(t){let e=0;for(const n of ue){const i=this.equipment[n];if(i){const n=fe(de,i);e+=n.attributes?.[t]??0}}return(this.entry.baseAttributes[t]??0)+(this.level.value-1)*(this.entry.levelAdvancement[t]??0)+e}scheduleQuest(t){if(this.activity.kind!==Ce.IDLE)throw new Error("Cannot schedule a quest when the hero is not IDLE.");const e=ke.get(t);if(e.levelRequirement>this.level.value)throw new Error("Hero must meet the level requirement of a quest.");const n=e.levelRequirement-this.level.value,i=e.baseDurationMs*(n<0?.75/(1-n/3)+.25:1+Math.sqrt(n));this.state.patch({activity:{kind:Ce.QUEST_PENDING,durationMs:i,elapsesAt:this.game.clock.now+i,questKey:t}})}completeQuest(){if(this.activity.kind!==Ce.QUEST_PENDING||this.activity.elapsesAt>this.game.clock.now)throw new Error("Cannot complete a quest when it did not elapse yet.");const t=ke.get(this.activity.questKey),e=[];if(Le.create([{entity:this,side:Ae.GOOD},{entity:new qe(t.enemyKey),side:Ae.EVIL}]).run(),this.health.isAlive){const n=t.levelRequirement-this.level.value,i=this.level.xpRequiredForNextLevel*t.xpModifier*(n<0?1/(1-n):1+(n/2)**2);this.state.patch({activity:{kind:Ce.QUEST_READY,loot:ge.generateLoot(t.lootTable),combatEvents:e,xp:i}})}else this.state.patch({activity:{combatEvents:e,kind:Ce.DEAD}})}deliverQuest(){if(this.activity.kind!==Ce.QUEST_READY)throw new Error("Cannot deliver quest loot when not ready.");this.game.inventory.add(this.activity.loot),this.level.xp+=this.activity.xp,this.state.patch({activity:{kind:Ce.IDLE}})}revive(){if(this.activity.kind!==Ce.DEAD)throw new Error("Cannot revive hero when not dead.");this.health.reset(),this.state.patch({activity:{kind:Ce.IDLE}})}equip(t){const e=fe(de,t);if(void 0===e.slot)throw new Error("This item does not fit into any slots.");this.game.inventory.remove([{itemKey:t,quantity:1}]);const n=this.equipment[e.slot];n&&this.game.inventory.add([{itemKey:n,quantity:1}]),this.state.patch({equipment:{...this.equipment,[e.slot]:t}})}static registry=new se;static create(t){const e=Fe.registry.get(t);return{key:t,equipment:e.startEquipment,healthDeficit:0,rotation:e.rotation,xp:0,activity:{kind:Ce.IDLE}}}}!function(t){t[t.RECRUITMENT_LIMIT_REACHED=0]="RECRUITMENT_LIMIT_REACHED",t[t.CRAFTER_ALREADY_RECRUITED=1]="CRAFTER_ALREADY_RECRUITED",t[t.NOT_ENOUGH_INVENTORY_SPACE=2]="NOT_ENOUGH_INVENTORY_SPACE",t[t.MISSING_REQUIRED_ITEMS=3]="MISSING_REQUIRED_ITEMS"}(we||(we={}));class He extends Error{kind;isPlayerError=!0;constructor(t,e){super(`${we[t]}${e?`: ${e}`:""}`),this.kind=t}static isPlayerError(t){return"object"==typeof t&&null!==t&&t.isPlayerError}}class Ge{state;constructor(t){this.state=t}get capacity(){return this.state.current.capacity}set capacity(t){if(t<this.state.current.contents.length)throw new Error("Cannot reduce capacity below currently occupied space.");this.state.patch({capacity:t})}get contents(){return this.state.current.contents}add(t){const e=this.contents.slice();for(const n of t){const t=fe(de,n.itemKey);let i=n.quantity;for(let r=0;r<e.length&&i>0;++r){const s=e[r];if(n.itemKey!==s.itemKey)continue;const o=Math.min(i,t.maxStack-s.quantity);e[r]={...s,quantity:s.quantity+o},i-=o}for(;i>0;){if(e.length===this.capacity)throw new He(we.NOT_ENOUGH_INVENTORY_SPACE);e.push({itemKey:n.itemKey,quantity:Math.min(i,t.maxStack)}),i-=t.maxStack}}this.state.patch({contents:e})}remove(t){const e=this.contents.slice();for(const n of t){let t=n.quantity;for(let i=e.length-1;i>=0&&t>0;--i){const r=e[i];n.itemKey===r.itemKey&&(r.quantity<=t?(e.splice(i,1),t-=r.quantity):(e[i]={...r,quantity:r.quantity-t},t=0))}if(t>0)throw new He(we.MISSING_REQUIRED_ITEMS)}this.state.patch({contents:e})}count(t){return ye(this.contents,(e=>e.itemKey===t?e.quantity:0))}}function Ke(){this.t=[]}function Ue(){this.i=new Set,this.u=[]}function Ve(t){return t&&"function"==typeof t.then}function $e(t,e,n){return new Promise(((i,r)=>{const{length:s}=e;let o=0;const a=()=>{0==--o&&i()};for(let i=0;i<s;++i){const s=e[i].call(t,n);Ve(s)&&(++o,s.then(a,r))}}))}function Ye(t,e,n){return new Promise(((i,r)=>{const{length:s}=e;let o=0;const a=()=>{if(o>=s)return void i();const c=e[o++].call(t,n);Ve(c)?c.then(a,r):a()};a()}))}Ke.prototype.o=null,Ke.prototype.h=function(){return this.o||(this.o=this.t.slice()),this.o},Ke.prototype.l=function(t){this.t.push(t),this.o=null},Ke.prototype.g=function(){return 0!==this.t.length&&(this.t=[],this.o=null,!0)},Ke.prototype.m=function(){return this.t.length},Ke.prototype.P=function(t){const{t:e}=this;let n,i=e.length-1;for(;i>=0&&(n=e[i],n!==t&&n.p!==t);)--i;return-1!==i&&(this.t.splice(i,1),this.o=null,!0)},Ke.prototype.v=function(t){const e=this.t.lastIndexOf(t);-1!==e&&(this.t.splice(e,1),this.o=null)},Ue.prototype.o=null,Ue.prototype.h=function(){return this.o||(this.o=Array.from(this.i.values()).concat(this.u)),this.o},Ue.prototype.l=function(t){if(t.p){if(this.i.has(t.p))return;this.u.push(t)}else this.i.add(t),this.A(t);this.o=null},Ue.prototype.g=function(){return!!this.m()&&(this.i.clear(),this.u=[],this.o=null,!0)},Ue.prototype.m=function(){return this.i.size+this.u.length},Ue.prototype.P=function(t){return this.i.delete(t)?(this.o=null,!0):this.A(t)},Ue.prototype.v=function(t){const e=this.u.lastIndexOf(t);-1!==e&&(this.u.splice(e,1),this.o=null)},Ue.prototype.A=function(t){let e=this.u.length-1;for(;e>=0;){if(this.u[e].p===t)return this.u.splice(e,1),this.o=null,!0;--e}return!1};const Qe={array:Ke,set:Ue};class Be{timeSource;changed=function(t={}){const e=new(Qe[t.backend]??Ke),n=!0===t.async,i=n?function(t,e){const n=e?.parallel?$e:Ye;return function(e){return n(this,t.h(),e)}}(e,t):function(t,e){return function(e){const n=t.h(),{length:i}=n;for(let t=0;t<i;++t)n[t].call(this,e)}}(e);return i.S=e,i.isAsync=n,i}();offset;constructor(t=performance){this.timeSource=t,this.offset=Date.now()-t.now()}get now(){return this.offset+this.timeSource.now()}set now(t){const e=this.timeSource.now(),n=this.offset+e;this.offset=t-e,this.changed({oldTime:n,newTime:t})}}function We(t,e){return t.timestamp-e.timestamp}class ze{clock;maxTimeoutMs;handle;handleCounter=0;queue=[];constructor(t,e=3e4){this.clock=t,this.maxTimeoutMs=e,function(t,e,n){n?.once?function(t,e){let n=!1;const i=function(r){if(!n)return t.S.v(i),n=!0,e.call(this,r)};i.p=e,t.S.l(i)}(t,e):t.S.l(e)}(t.changed,this.scheduleNextTick)}dispose(){!function(t,e){e?t.S.P(e):t.S.g()}(this.clock.changed,this.scheduleNextTick)}setTimeout(t,e){return this.insertAndSchedule(t,e,!1)}setInterval(t,e){return this.insertAndSchedule(t,e,!0)}scheduleCallbackAt(t,e){const n=++this.handleCounter;for(let i=0;i<e.length;++i)this.insert({callback:t,handle:n,timestamp:e[i]});return n}clear(t){this.queue=this.queue.filter((e=>e.handle!==t)),this.scheduleNextTick()}insertAndSchedule(t,e,n){const i={callback:t,handle:++this.handleCounter,interval:n?e:void 0,timestamp:this.clock.now+e};return this.insert(i),this.scheduleNextTick(),i.handle}insert(t){let e=function(t,e,n){let i,r,s=0,o=t.length;for(;s<o;)if(i=s+o>>>1,r=n(e,t[i]),r>0)s=i+1;else{if(!(r<0))return i;o=i}return-s-1}(this.queue,t,We);if(e<0)e=-e-1;else do{++e}while(e<this.queue.length&&0===We(this.queue[e],t));this.queue.splice(e,0,t)}scheduleNextTick=()=>{const t=pe(this.queue)?.timestamp;if(void 0===t)return;this.cancelTick();const e=me(t-this.clock.now,0,this.maxTimeoutMs);this.handle=setTimeout(this.tick,e)};cancelTick(){void 0!==this.handle&&(clearTimeout(this.handle),this.handle=void 0)}tick=()=>{const{now:t}=this.clock;let e=0;for(;e<this.queue.length&&!(this.queue[e].timestamp>t);)++e;const n=this.queue.splice(0,e);try{for(let i=0;i<e;++i){const e=n[i];e.callback(t),e.interval&&this.insert({...e,timestamp:t+e.interval})}}finally{this.handle=void 0,this.scheduleNextTick()}}}le.registry.add({key:"HERBALIST",icon:"⚗️",recipes:[{result:{itemKey:de.HEALTH_POTION.key,quantity:1},minLevel:1,baseDurationMs:5e3,materials:[{itemKey:de.BERRY.key,quantity:2}]},{result:{itemKey:de.COCAINE.key,quantity:1},minLevel:1,baseDurationMs:1e4,materials:[{itemKey:de.COCA_LEAVES.key,quantity:2}]}]}),le.registry.add({key:"BLACKSMITH",icon:"🔨",recipes:[{result:{itemKey:de.SWORD.key,quantity:1},minLevel:1,baseDurationMs:5e3,materials:[{itemKey:de.STONE.key,quantity:3},{itemKey:de.WOODEN_LOG.key,quantity:2}]}]}),le.registry.add({key:"CARVER",icon:"🪵",recipes:[{result:{itemKey:de.STAFF.key,quantity:1},minLevel:1,baseDurationMs:5e3,materials:[{itemKey:de.WOODEN_LOG.key,quantity:2},{itemKey:de.SKULL.key,quantity:1}]},{result:{itemKey:de.MARTINUV_GLOSAR.key,quantity:1},minLevel:1,baseDurationMs:7e3,materials:[{itemKey:de.WOODEN_LOG.key,quantity:2}]}]}),qe.registry.add({key:"GATHERING_BUSH",icon:"🌳",attributes:{[he.STAMINA]:10},rotation:[Se.NONE.key,Se.NONE.key,Se.NONE.key]}),qe.registry.add({key:"IRON_GOLEM",icon:"🗿",attributes:{[he.STRENGTH]:50,[he.STAMINA]:50},rotation:[Se.LUNGE.key,Se.LUNGE.key,Se.LUNGE.key]}),qe.registry.add({key:"SKELETON",icon:"💀",attributes:{[he.STAMINA]:5,[he.STRENGTH]:5,[he.MAGIC_DEFENSE]:15,[he.PHYSICAL_DEFENSE]:5},rotation:[Se.LUNGE.key,Se.LUNGE.key,Se.LUNGE.key]}),qe.registry.add({key:"STONER",icon:"🗿",attributes:{[he.STAMINA]:10,[he.STRENGTH]:5,[he.MAGIC_DEFENSE]:5,[he.PHYSICAL_DEFENSE]:15},rotation:[Se.LUNGE.key,Se.LUNGE.key,Se.LUNGE.key]}),qe.registry.add({key:"TREE_GUY",icon:"🌲",attributes:{[he.STAMINA]:5,[he.INTELLECT]:5,[he.MAGIC_DEFENSE]:10,[he.PHYSICAL_DEFENSE]:10},rotation:[Se.FIREBALL.key,Se.FIREBALL.key,Se.FIREBALL.key]}),qe.registry.add({key:"COCA_PLANT",icon:"🪴",attributes:{[he.STAMINA]:30},rotation:[Se.NONE.key,Se.NONE.key,Se.NONE.key]}),Fe.registry.add({key:"MAGE",icon:"🧙",baseAttributes:{[he.STAMINA]:15,[he.INTELLECT]:10,[he.MAGIC_DEFENSE]:20},levelAdvancement:{[he.STAMINA]:2,[he.INTELLECT]:2,[he.MAGIC_DEFENSE]:5},rotation:[Se.FIREBALL.key,Se.FIREBALL.key,Se.FIREBALL.key],startEquipment:{[ce.WEAPON]:de.STAFF.key}}),Fe.registry.add({key:"WARRIOR",icon:"🧝",baseAttributes:{[he.STAMINA]:20,[he.STRENGTH]:10,[he.PHYSICAL_DEFENSE]:20},levelAdvancement:{[he.STAMINA]:5,[he.STRENGTH]:2,[he.PHYSICAL_DEFENSE]:5},rotation:[Se.SUNDER.key,Se.LUNGE.key,Se.LUNGE.key],startEquipment:{[ce.WEAPON]:de.SWORD.key,[ce.HEAD]:de.CHAIN_HOOD.key,[ce.CHEST]:de.CHAIN_VEST.key,[ce.LEGS]:de.CHAIN_LEGGINGS.key,[ce.RING]:de.APPRENTICE_RING.key}}),ke.add({key:"GATHERING_1",enemyKey:"GATHERING_BUSH",baseDurationMs:1e4,xpModifier:.333,levelRequirement:1,lootTable:[{items:[{itemKey:de.BERRY.key,maxQuantity:5,minQuantity:2}],probability:100}]}),ke.add({key:"STONER",enemyKey:"STONER",baseDurationMs:15e3,xpModifier:.2,levelRequirement:2,lootTable:[{items:[{itemKey:de.STONE.key,maxQuantity:5,minQuantity:2}],probability:100}]}),ke.add({key:"TREE_GUY",enemyKey:"TREE_GUY",baseDurationMs:15e3,xpModifier:.2,levelRequirement:2,lootTable:[{items:[{itemKey:de.WOODEN_LOG.key,maxQuantity:5,minQuantity:2}],probability:100}]}),ke.add({key:"SKELETON",enemyKey:"SKELETON",baseDurationMs:3e4,xpModifier:.3,levelRequirement:3,lootTable:[{items:[{itemKey:de.BONE.key,maxQuantity:3,minQuantity:1}],probability:75},{items:[{itemKey:de.BONE.key,maxQuantity:2,minQuantity:1},{itemKey:de.SKULL.key,maxQuantity:1,minQuantity:1}],probability:25}]}),ke.add({enemyKey:"IRON_GOLEM",key:"IRON_GOLEM",baseDurationMs:3e5,xpModifier:1,levelRequirement:5,lootTable:[]}),ke.add({enemyKey:"COCA_PLANT",key:"GATHERING_2",baseDurationMs:2e4,xpModifier:.2,levelRequirement:5,lootTable:[{items:[{itemKey:de.COCA_LEAVES.key,maxQuantity:5,minQuantity:2}],probability:100}]});class je{state;clock;scheduler;inventory;_crafters;_heroes;constructor(t){this.state=t,this.clock=new Be,this.scheduler=new ze(this.clock),t.init({crafters:[le.create("BLACKSMITH"),le.create("CARVER"),le.create("HERBALIST")],heroes:[Fe.create("WARRIOR")],inventory:{capacity:40,contents:[]}});const e=t.subState("crafters");this._crafters=t.current.crafters.map(((t,n)=>new le(this,e.subState(n))));const n=t.subState("heroes");this._heroes=t.current.heroes.map(((t,e)=>new Fe(this,n.subState(e)))),this.inventory=new Ge(t.subState("inventory"))}get crafters(){return this._crafters}get heroes(){return this._heroes}recruitHero(t){const{heroes:e}=this.state.current;if(10===e.length)throw new He(we.RECRUITMENT_LIMIT_REACHED);this.state.patch({heroes:[...e,Fe.create(t)]}),this._heroes.push(new Fe(this,this.state.subState("heroes").subState(e.length)))}recruitCrafter(t){const{crafters:e}=this.state.current;if(e.some((e=>e.key===t)))throw new He(we.CRAFTER_ALREADY_RECRUITED);this.state.patch({crafters:[...e,le.create(t)]}),this._crafters.push(new le(this,this.state.subState("crafters").subState(e.length)))}}const Je="CRAFTERS",Xe="CRAFTING_LIST",Ze="CRAFTING_RECIPE",tn="CRAFTING_END",en="HEROES",nn="HERO_RECRUIT",rn="HERO_EDIT",sn="HERO_EQUIP_ITEM",on="HERO_DEATH",an="HERO_HEAL_SCREEN",cn="QUEST_SELECT",ln="QUEST_START",un="QUEST_END",hn=({class:t,children:e})=>f("div",{class:zt("flat-layout",t)},e),_n=({class:t,children:e})=>f("h2",{class:zt(Wt("typography-header",{main:!0}),t)},e),fn=({class:t,children:e})=>f("h3",{class:zt(Wt("typography-header",{sub:!0}),t)},e);function dn(t){return!t}function yn(){return wt(dn,!1)[1]}function pn(t,e){const n=yn();Dt((()=>{if(0===e.length)return;const i=t.scheduleCallbackAt(n,e);return()=>t.clear(i)}),e)}const mn=({scheduler:t,timestamp:e})=>{const{t:n}=Yt(),i=e-t.clock.now;return function(t,e){const n=yn();Dt((()=>{if(void 0===e||e<1)return;const i=t.setInterval(n,e);return()=>t.clear(i)}),[e])}(t,i>0?1e3:void 0),f("span",{class:"countdown"},n(function(t){for(const e of En){const n=Math.floor(t/e.ms);if(n>=1)return{key:e.key,vars:{remaining:n}}}return{text:""}}(i)))},En=[{key:"ui.time.days",ms:864e5},{key:"ui.time.hours",ms:36e5},{key:"ui.time.minutes",ms:6e4},{key:"ui.time.seconds",ms:1e3}];const vn=({class:t,icon:e,onClick:n,quantity:i})=>f("div",{class:zt("icon",t),onClick:n},f("svg",{viewBox:"0 0 100 100"},f("text",{style:"font-size: 80","alignment-baseline":"middle","text-anchor":"middle",x:50,y:60},e)),e&&i&&f("span",{class:"icon__quantity"},i)),gn=({action:t,actionContent:e="➡️",actionDisabled:n=!1,children:i,class:r,icon:s,quantity:o,secondaryAction:a,title:c})=>f("div",{class:zt(Wt("entry-card",{"has-action":Boolean(t)}),r)},f(vn,{class:"entry-card__icon",icon:s,quantity:o,onClick:a}),f("div",{class:"entry-card__meta"},c&&f(fn,null,c),i),t&&f(jt,{class:"entry-card__action",disabled:n,onClick:()=>t()},e));function kn(t){return Math.trunc(t).toString()}const An=({class:t,formatValue:n=kn,hideLabel:i,maxValue:r,title:s,value:o})=>{const a=function(t){return gt=5,Lt((function(){return{current:t}}),[])}();return function(t,n){var i=Rt(pt++,4);!e.__s&&Ht(i.__H,n)&&(i.__=t,i.i=n,mt.__h.push(i))}((()=>{a.current?.style.setProperty("--progress",""+o/r)}),[o,r]),f("div",{class:zt("progress-bar",t),ref:a},f("div",{class:"progress-bar__indicator"}),!i&&f("span",{class:"progress-bar__label"},`${s?`${s}: `:""}${n(o)} / ${n(r)}`))},Tn={[ae.IDLE]:(t,{crafter:e,router:n,t:i,...r})=>f(gn,{...r,action:()=>n.navigate(Xe,{crafter:e})},f(An,{value:e.level.xpThisLevel,maxValue:e.level.xpRequiredForNextLevel})),[ae.CRAFT_PENDING]:(t,{game:e,crafter:n,router:i,t:r,...s})=>{const o=t.elapsesAt-e.clock.now;return f(gn,{...s,action:()=>{n.completeCraft(),i.navigate(tn,{crafter:n})},actionDisabled:o>0,actionContent:o>0?f(mn,{scheduler:e.scheduler,timestamp:t.elapsesAt}):void 0},f(fn,null,r("ui.crafter-state."+(o>0?"CRAFT_PENDING":"CRAFT_READY"))))},[ae.CRAFT_READY]:(t,{crafter:e,router:n,t:i,...r})=>f(gn,{...r,action:()=>n.navigate(tn,{crafter:e})},f(fn,null,i("ui.crafter-state.CRAFT_READY")))},bn=({game:t})=>{const{t:e}=Yt(),n=te();pn(t.scheduler,t.crafters.filter((t=>t.activity.kind===ae.CRAFT_PENDING)).map((t=>t.activity.elapsesAt)));const i=f(_n,null,e("ui.title.crafters"));return f(hn,null,f(Xt,{header:i,items:t.crafters,itemRenderer:i=>{return r={game:t,crafter:i,router:n,t:e,icon:i.icon,title:e(`entity.${i.key}`),quantity:i.level.value},Tn[r.crafter.activity.kind](r.crafter.activity,r);var r}}))},Nn=({class:t,children:e})=>f("div",{class:zt("button-group",t)},e),In=()=>{const{t:t}=Yt(),e=te(),{crafter:n}=e.params,{loot:i}=n.activity;return f(hn,null,f(gn,{icon:fe(de,i.itemKey).icon,quantity:i.quantity,title:t(`item.${i.itemKey}`)}),f(Nn,null,f(jt,{onClick:()=>{n.deliverCraft(),e.navigate(Je)}},t("ui.label.end-task"))))},Sn=()=>{const{t:t}=Yt(),e=te(),{crafter:n}=e.params,i=f(_n,null,t("ui.title.recipes"));return f(hn,null,f(Xt,{header:i,items:n.recipes,itemRenderer:i=>f(gn,{icon:fe(de,i.result.itemKey).icon,title:t(`item.${i.result.itemKey}`),actionDisabled:n.level.value<i.minLevel,action:()=>{e.navigate(Ze,{crafter:n,recipe:i})}})}))},Rn=({game:t})=>{const{t:e}=Yt(),n=te(),[i,r]=Ct(1),{crafter:s,recipe:o}=n.params,a=f(_n,null,e("ui.title.craft-item",{item:e(`item.${o.result.itemKey}`)})),{maxStack:c}=fe(de,o.result.itemKey),l=Math.min(c,Math.floor(function(t,e){let n=1/0;for(const i of t)n=Math.min(n,e(i));return n}(o.materials,(e=>t.inventory.count(e.itemKey)/e.quantity)))),u=l<=1||1===i,h=l<=1||i===l;return f(hn,null,f(Xt,{header:a,items:o.materials,itemRenderer:t=>f(gn,{icon:fe(de,t.itemKey).icon,quantity:t.quantity*i,title:e(`item.${t.itemKey}`)})}),f("div",{class:"crafting-recipe__controls"},f(jt,{class:"crafting-recipe__quantity-min",disabled:u,onClick:()=>r(1)},e("ui.label.minimum")),f(jt,{class:"crafting-recipe__quantity-decrease",disabled:u,onClick:()=>r(i-1)},e("ui.label.minus")),f("span",{class:"crafting-recipe__quantity-value"},i),f(jt,{class:"crafting-recipe__quantity-increase",disabled:h,onClick:()=>r(i+1)},e("ui.label.plus")),f(jt,{class:"crafting-recipe__quantity-max",disabled:h,onClick:()=>r(l)},e("ui.label.maximum")),f(jt,{class:"crafting-recipe__start-button",disabled:0===l,onClick:()=>{s.scheduleCraft(o,i),n.navigate(Je)}},e("ui.label.start-task"))))},Cn=()=>{const{t:t}=Yt(),e=te(),{hero:n}=e.params;return f(hn,null,f(_n,null,t("ui.title.hero-death")),f(gn,{icon:n.icon,title:t(`entity.${n.key}`),action:()=>{n.revive(),e.navigate(en)}}))},wn=()=>{const{t:t}=Yt(),e=te(),{hero:n}=e.params,i=f("header",{class:"edit-hero-screen__header"},f(_n,null,t("ui.title.equipment")));return f(hn,null,f(gn,{icon:n.icon,quantity:n.level.value,action:()=>{e.navigate(an,{hero:n})}},t(`entity.${n.key}`),f(An,{title:t("ui.label.hp"),value:n.health.value,maxValue:n.health.maxHealth}),f(An,{title:t("ui.label.xp"),value:n.level.xpThisLevel,maxValue:n.level.xpRequiredForNextLevel})),f(Xt,{header:i,items:ue,itemRenderer:i=>{const r=n.equipment[i];return f(gn,{icon:r?fe(de,r).icon:void 0,title:r&&t(`item.${r}`),action:()=>{e.navigate(sn,{hero:n,slot:i})}})}}))},Dn=({game:t})=>{const{t:e}=Yt(),n=te(),{hero:i,slot:r}=n.params,s=f("header",{class:"hero-equip-item__header"},f(_n,null,e("ui.title.hero-equip-item"),f("br",null),e(`entity.${i.key}`))),o=t.inventory.contents.filter((t=>fe(de,t.itemKey).slot===r));return f(Xt,{header:s,items:o,itemRenderer:t=>f(gn,{icon:fe(de,t.itemKey).icon,title:e(`item.${t.itemKey}`),action:()=>{i.equip(t.itemKey),n.navigate(rn,{hero:i})}})})},Ln=({game:t})=>{const{t:e}=Yt(),n=te(),{hero:i}=n.params,r=f("header",{class:"hero-heal__header"},f(_n,null,e("ui.title.hero-heal"),f("br",null),e(`entity.${i.key}`))),s=t.inventory.contents.filter((t=>void 0!==fe(de,t.itemKey).healValue)),o=yn();return f(hn,null,f(gn,{icon:i.icon},f(An,{value:i.health.value,maxValue:i.health.maxHealth,title:e("ui.label.hp")})),f(Xt,{header:r,items:s,itemRenderer:n=>f(gn,{icon:fe(de,n.itemKey).icon,title:e(`item.${n.itemKey}`),quantity:n.quantity,action:()=>{i.health.value!==i.health.maxHealth&&(i.health.value+=fe(de,n.itemKey).healValue,t.inventory.remove([{itemKey:n.itemKey,quantity:1}]),o())}})}))},xn=({class:t,children:e,header:n})=>f("div",{class:zt("sticky-layout",t)},n&&f("header",{class:"sticky-layout__header"},n),e),On=({game:t})=>{const{t:e}=Yt(),n=te(),[i,r]=Ct(null),s=i?Fe.registry.get(i):null,o=f("header",{class:"recruit-screen__header"},f(_n,null,e("ui.title.recruit-hero")),f(gn,{icon:s?.icon,title:s?e(`entity.${s.key}`):void 0,actionDisabled:!s,action:()=>{t.recruitHero(i),n.navigate(en)}}));return f(xn,{header:o},f(Xt,{items:Fe.registry.keys,itemRenderer:t=>f(jt,{key:t,selected:t===i,onClick:()=>r(t),children:e(`entity.${t}`)})}))},Pn={[Ce.DEAD]:(t,{hero:e,router:n,t:i,...r})=>f(gn,{...r,icon:"💀",action:()=>n.navigate(on,{hero:e})},f(An,{value:0,maxValue:e.health.maxHealth,title:i("ui.label.hp")}),f(fn,null,i("ui.hero-state.died"))),[Ce.IDLE]:(t,{hero:e,router:n,t:i,...r})=>f(gn,{...r,action:()=>n.navigate(cn,{hero:e})},f(An,{value:e.health.value,maxValue:e.health.maxHealth,title:i("ui.label.hp")}),f(An,{value:e.level.xpThisLevel,maxValue:e.level.xpRequiredForNextLevel,title:i("ui.label.xp")})),[Ce.QUEST_PENDING]:(t,{game:e,hero:n,router:i,t:r,...s})=>{const o=t.elapsesAt-e.clock.now;return f(gn,{...s,action:()=>{n.completeQuest(),n.health.isAlive?i.navigate(un,{hero:n}):i.navigate(on,{hero:n})},actionDisabled:o>0,actionContent:o>0?f(mn,{scheduler:e.scheduler,timestamp:t.elapsesAt}):void 0},f(fn,null,r("ui.hero-state."+(o>0?"quest-pending":"quest-ready"))))},[Ce.QUEST_READY]:(t,{hero:e,router:n,t:i,...r})=>f(gn,{...r,action:()=>n.navigate(un,{hero:e})},f(fn,null,i("ui.hero-state.quest-ready")))},Mn=({game:t})=>{const{t:e}=Yt(),n=te();pn(t.scheduler,t.heroes.filter((t=>t.activity.kind===Ce.QUEST_PENDING)).map((t=>t.activity.elapsesAt)));const i=f(_n,null,e("ui.title.heroes")),r=f(jt,{disabled:t.heroes.length>=10,onClick:()=>n.navigate(nn)},e("ui.label.recruit-hero"));return f(hn,null,f(Xt,{header:i,footer:r,items:t.heroes,itemRenderer:i=>{return r={game:t,hero:i,router:n,t:e,icon:i.icon,title:e(`entity.${i.key}`),quantity:i.level.value,secondaryAction:()=>n.navigate(rn,{hero:i})},Pn[r.hero.activity.kind](r.hero.activity,r);var r}}))},qn=({class:t,content:e,onClickItem:n})=>f("div",{class:zt("item-grid",t)},e.map(((t,e)=>f(vn,{key:e,quantity:t?.quantity,icon:t?fe(de,t.itemKey).icon:void 0,onClick:()=>n?.(t,e)})))),Fn=({game:t})=>{const{t:e}=Yt(),[n,i]=Ct(-1),{capacity:r,contents:s}=t.inventory,o=new Array(r);for(let t=0;t<r;++t)o[t]=t<s.length?s[t]:null;const a=o[n],c=f(y,null,f(_n,null,e("ui.title.inventory")),f(gn,{class:"item-grid__detail",icon:a?fe(de,a.itemKey).icon:void 0,quantity:a?.quantity,title:a?e(`item.${a.itemKey}`):void 0}));return f(xn,{header:c},f(qn,{content:o,onClickItem:(t,e)=>i(e)}))},Hn=()=>{const{t:t}=Yt(),e=te(),{hero:n}=e.params,{loot:i}=n.activity;return f(hn,null,f(_n,null,t("ui.title.quest-loot")),f(qn,{content:i}),f(Nn,null,f(jt,{onClick:()=>{n.deliverQuest(),e.navigate(en)}},t("ui.label.end-quest"))))},Gn=()=>{const{t:t}=Yt(),e=te(),{hero:n}=e.params;return f(hn,null,f(Xt,{header:f(_n,null,t("ui.title.quest-select")),items:ke.keys,itemRenderer:i=>{const r=ke.get(i),s=qe.registry.get(r.enemyKey);return f(gn,{icon:s.icon,quantity:r.levelRequirement,title:t(`quest.${r.key}.name`),actionDisabled:r.levelRequirement>n.level.value,action:()=>e.navigate(ln,{hero:n,quest:r})},f("p",{class:"quest-select__description"},t(`quest.${r.key}.desc`)))}}))},Kn=t=>{const{t:e}=Yt(),{entity:n}=t;return f("div",{class:zt("entity-detail",t.class)},f(_n,null,e(`entity.${n.key}`)),f(An,{maxValue:n.health.maxHealth,value:n.health.value,title:e("ui.label.hp")}),f(fn,null,e("ui.label.stats")),f("dl",{class:"entity-detail__attributes"},function(t,e){const n=[];for(const i in t){const r=t[i];"string"==typeof r&&Object.prototype.hasOwnProperty.call(t,r)||n.push(e(r,i))}return n}(he,((t,i)=>f(y,null,f("dt",null,e(`attribute.${i}`)),f("dd",null,n.getAttribute(t)))))),f(fn,null,e("ui.label.rotation")),f("ol",{class:"entity-detail__rotation"},n.rotation.map(((t,n)=>f("li",{key:n},f("em",null,e(`attack.${t}`)))))))},Un=()=>{const{t:t}=Yt(),e=te(),{hero:n,quest:i}=e.params;return f(hn,{class:"quest-start"},f(_n,{class:"quest-start__header"},t("ui.title.quest-start")),f(Kn,{class:"quest-start__hero-detail",entity:n}),f("div",{class:"quest-start__quest-prompt"},f("span",{class:"quest-start__versus"},t("ui.label.versus")),f(jt,{class:"quest-start__start-button",onClick:()=>{n.scheduleQuest(i.key),e.navigate(en)}},t("ui.label.start-quest"))),f(Kn,{class:"quest-start__enemy-detail",entity:new qe(i.enemyKey)}))},Vn=()=>{const{t:t}=Yt();return f(hn,null,f(_n,null,t("ui.title.shop")))};function $n(){const t=new re(new ne({key:"game-state"})),e=new je(t),n=t=>()=>t({game:e});return window.tickFiveMins=()=>{e.clock.now+=3e5},[{path:Je,content:n(bn),visible:!0},{path:Xe,content:n(Sn)},{path:Ze,content:n(Rn)},{path:tn,content:n(In)},{path:"INVENTORY",content:n(Fn),visible:!0},{path:"SHOP",content:n(Vn),visible:!0},{path:en,content:n(Mn),visible:!0},{path:nn,content:n(On)},{path:rn,content:n(wn)},{path:sn,content:n(Dn)},{path:on,content:n(Cn)},{path:an,content:n(Ln)},{path:cn,content:n(Gn)},{path:ln,content:n(Un)},{path:un,content:n(Hn)}]}!function(n,i,r){var s,o,a;e.__&&e.__(n,i),o=(s="function"==typeof r)?null:r&&r.__k||i.__k,a=[],w(i,n=(!s&&r||i).__k=f(y,null,[n]),o||c,c,void 0!==i.ownerSVGElement,!s&&r?[r]:o?null:i.firstChild?t.call(i.childNodes):null,a,!s&&r?r:o?o.__e:i.firstChild,s),D(a,n)}(f((()=>{const t=Lt($n,[]);return f(Qt,{url:"./locale/en.json"},f(ee,{initialPath:Je,routes:t}))}),null),document.getElementById("root"))}();
